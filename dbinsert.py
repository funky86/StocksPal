import datetime
import sqlite3
import stockslib

# all stocks with average volume > 100.000
symbols = ['A','AA','AABA','AAC','AAL','AAN','AAOI','AAON','AAP','AAPL','AAT','AAU','AAV','AAWW','AAXJ','AAXN','AB','ABAX','ABB','ABBV','ABC','ABCB','ABCD','ABEO','ABEV','ABG','ABIO','ABLX','ABM','ABMD','ABR','ABT','ABUS','ABX','ACAD','ACC','ACCO','ACET','ACGL','ACH','ACHC','ACHN','ACHV','ACIA','ACIW','ACLS','ACM','ACN','ACOR','ACRE','ACRS','ACRX','ACST','ACTA','ACTG','ACWI','ACWV','ACWX','ACXM','ADAP','ADBE','ADC','ADES','ADI','ADM','ADMA','ADMP','ADMS','ADNT','ADOM','ADP','ADRO','ADS','ADSK','ADSW','ADT','ADTN','ADVM','ADX','ADXS','AEE','AEG','AEGN','AEHR','AEIS','AEL','AEM','AEMD','AEO','AEP','AER','AERI','AES','AET','AEZS','AFB','AFG','AFH','AFI','AFL','AFMD','AFSI','AG','AGC','AGCO','AGEN','AGFS','AGG','AGGP','AGI','AGII','AGIO','AGLE','AGN','AGNC','AGO','AGQ','AGR','AGRO','AGRX','AGS','AGTC','AGX','AHGP','AHH','AHL','AHP','AHPA','AHT','AI','AIA','AIG','AIMC','AIMT','AIN','AINV','AIPT','AIR','AIT','AIV','AIZ','AJG','AJRD','AKAM','AKAO','AKBA','AKCA','AKER','AKG','AKR','AKRX','AKS','AKTS','AKTX','AL','ALB','ALDR','ALE','ALEX','ALGN','ALGT','ALIM','ALK','ALKS','ALL','ALLE','ALLY','ALN','ALNY','ALO','ALOG','ALRM','ALSK','ALSN','ALT','ALTR','ALV','ALXN','AM','AMAG','AMAT','AMBA','AMBC','AMBR','AMC','AMCN','AMCX','AMD','AMDA','AME','AMED','AMG','AMGN','AMGP','AMH','AMID','AMJ','AMKR','AMLP','AMMA','AMN','AMP','AMPE','AMPH','AMR','AMRC','AMRN','AMRS','AMSC','AMT','AMTD','AMTX','AMU','AMWD','AMX','AMZA','AMZN','AN','ANAB','ANDE','ANDV','ANDX','ANET','ANF','ANFI','ANGI','ANGL','ANGO','ANH','ANIK','ANIP','ANSS','ANTH','ANTM','ANTX','ANW','ANY','AOBC','AOD','AOI','AOM','AON','AOR','AOS','AOSL','APA','APAM','APC','APD','APEI','APH','APHB','APLE','APLP','APLS','APO','APOG','APPF','APPN','APPS','APRI','APRN','APTI','APTO','APTS','APTV','APU','APVO','AQ','AQB','AQMS','AQN','AQUA','AQXP','AR','ARA','ARAY','ARC','ARCB','ARCC','ARCH','ARCO','ARD','ARDM','ARDX','ARE','ARES','AREX','ARGS','ARGT','ARGX','ARI','ARKG','ARKK','ARKW','ARLP','ARLZ','ARMK','ARMO','ARNA','ARNC','AROC','ARQL','ARR','ARRS','ARRY','ARTX','ARW','ARWR','ASA','ASB','ASC','ASGN','ASH','ASHR','ASIX','ASM','ASMB','ASML','ASNA','ASND','ASPS','AST','ASTC','ASTE','ASUR','ASX','ASYS','AT','ATEN','ATGE','ATH','ATHM','ATHN','ATHX','ATI','ATKR','ATNM','ATNX','ATO','ATOM','ATOS','ATR','ATRA','ATRC','ATRO','ATRS','ATSG','ATTO','ATU','ATUS','ATVI','AU','AUG','AUMN','AUO','AUPH','AUTO','AUY','AVA','AVAL','AVAV','AVB','AVD','AVDL','AVEO','AVGO','AVGR','AVH','AVID','AVP','AVT','AVX','AVXL','AVXS','AVY','AWF','AWI','AWK','AWP','AWR','AXAS','AXDX','AXE','AXGN','AXL','AXON','AXP','AXS','AXSM','AXTA','AXTI','AXU','AY','AYI','AYR','AYTU','AYX','AZN','AZO','AZPN','AZUL','AZZ','B','BA','BAB','BABA','BABY','BAC','BAH','BAK','BAM','BANC','BAND','BANR','BAP','BAS','BATRK','BAX','BB','BBBY','BBD','BBL','BBN','BBOX','BBRG','BBT','BBVA','BBW','BBX','BBY','BC','BCC','BCE','BCEI','BCO','BCOR','BCOV','BCPC','BCRX','BCS','BCX','BDC','BDCL','BDJ','BDN','BDR','BDSI','BDX','BDXA','BEAT','BECN','BEDU','BEL','BEN','BEP','BERY','BF-B','BFAM','BFK','BFR','BG','BGB','BGC','BGCP','BGFV','BGG','BGNE','BGR','BGS','BGY','BHE','BHF','BHGE','BHK','BHLB','BHP','BHVN','BIB','BID','BIDU','BIF','BIG','BIIB','BIL','BIO','BIOA','BIOC','BIOL','BIOS','BIP','BIT','BITA','BIV','BJRI','BK','BKCC','BKD','BKE','BKH','BKI','BKLN','BKNG','BKS','BKT','BKU','BL','BLBD','BLCM','BLCN','BLD','BLDP','BLDR','BLK','BLKB','BLL','BLMN','BLOK','BLPH','BLRX','BLUE','BLV','BLX','BMA','BMCH','BMI','BMO','BMRN','BMS','BMY','BNCL','BND','BNDX','BNED','BNFT','BNO','BNS','BOE','BOFI','BOH','BOIL','BOJA','BOKF','BOLD','BOND','BOOT','BOTZ','BOX','BP','BPFH','BPI','BPL','BPMC','BPMP','BPMX','BPOP','BPT','BPTH','BPY','BR','BRC','BRFS','BRG','BRK-B','BRKL','BRKR','BRKS','BRO','BRS','BRSS','BRX','BRZU','BSAC','BSBR','BSCI','BSCJ','BSCK','BSCL','BSCM','BSIG','BSJI','BSJJ','BSJK','BSJL','BSM','BSMX','BSPM','BST','BSTI','BSV','BSX','BT','BTAI','BTE','BTG','BTI','BTT','BTU','BTX','BTZ','BUD','BUFF','BUR','BURL','BUSE','BVN','BW','BWA','BWP','BWX','BWXT','BX','BXC','BXE','BXG','BXMT','BXMX','BXP','BXS','BYD','BZH','BZQ','BZUN','C','CA','CAAP','CACC','CACI','CADE','CAE','CAF','CAFD','CAG','CAH','CAI','CAJ','CAKE','CAL','CALA','CALI','CALM','CALX','CAMP','CAMT','CAPR','CAR','CARA','CARB','CARG','CARS','CASA','CASI','CASY','CAT','CATB','CATM','CATO','CATY','CAVM','CB','CBA','CBAY','CBB','CBD','CBI','CBIO','CBK','CBL','CBM','CBOE','CBPO','CBPX','CBRE','CBRL','CBS','CBSH','CBT','CBU','CBZ','CC','CCE','CCI','CCIH','CCJ','CCK','CCL','CCLP','CCMP','CCO','CCOI','CCRC','CCRN','CCS','CCU','CCXI','CDE','CDEV','CDK','CDLX','CDMO','CDNA','CDNS','CDR','CDTI','CDTX','CDW','CDXC','CDXS','CDZI','CE','CECE','CECO','CEF','CEFL','CEI','CEIX','CELG','CEM','CEN','CENT','CENTA','CENX','CEO','CEPU','CEQP','CERC','CERN','CERS','CETV','CEVA','CF','CFFN','CFG','CFMS','CFR','CFRX','CFX','CG','CGA','CGEN','CGIX','CGNT','CGNX','CHAU','CHCI','CHCT','CHD','CHDN','CHE','CHEF','CHEK','CHFC','CHFS','CHGG','CHH','CHI','CHIQ','CHK','CHKP','CHKR','CHL','CHRS','CHRW','CHS','CHSP','CHT','CHTR','CHU','CHUBA','CHUBK','CHUY','CHW','CHY','CI','CIB','CIBR','CIEN','CIFS','CIG','CII','CIK','CIM','CINF','CIO','CIR','CISN','CIT','CIU','CIVI','CJ','CKH','CL','CLB','CLD','CLDR','CLDT','CLDX','CLF','CLGX','CLH','CLI','CLIR','CLLS','CLM','CLMT','CLNC','CLNE','CLNS','CLR','CLRB','CLRG','CLS','CLSD','CLSN','CLUB','CLVS','CLW','CLX','CLY','CM','CMA','CMC','CMCM','CMCO','CMCSA','CMD','CME','CMG','CMI','CMO','CMP','CMPR','CMRE','CMRX','CMS','CMSS','CMTL','CNA','CNAT','CNC','CNCE','CNDT','CNET','CNHI','CNI','CNIT','CNK','CNMD','CNNE','CNO','CNOB','CNP','CNQ','CNS','CNSL','CNTY','CNX','CNXM','CO','COBZ','CODI','COF','COG','COHR','COHU','COL','COLB','COLD','COLL','COLM','COMM','COMT','CONE','CONN','COO','COOL','COP','COR','CORE','CORI','CORT','COST','COT','COTV','COTY','COUP','COWN','CP','CPA','CPB','CPE','CPF','CPG','CPHI','CPLP','CPRT','CPRX','CPS','CPST','CPT','CQH','CQP','CQQQ','CR','CRAY','CRBP','CRC','CRCM','CREE','CRESY','CRF','CRH','CRI','CRIS','CRK','CRL','CRM','CRMD','CRME','CRNT','CRON','CROX','CRR','CRS','CRSP','CRTN','CRTO','CRUS','CRVS','CRY','CRZO','CS','CSCO','CSFL','CSGP','CSGS','CSII','CSIQ','CSJ','CSL','CSLT','CSOD','CSQ','CSTE','CSTM','CSU','CSV','CSX','CTAS','CTB','CTG','CTIC','CTL','CTLT','CTMX','CTRE','CTRL','CTRN','CTRP','CTRV','CTSH','CTSO','CTT','CTXS','CUB','CUBE','CUBI','CUK','CUR','CURE','CURO','CUTR','CUZ','CVA','CVBF','CVE','CVEO','CVG','CVGI','CVGW','CVI','CVLT','CVM','CVNA','CVON','CVRR','CVRS','CVS','CVTI','CVX','CW','CWB','CWEB','CWH','CWI','CWST','CWT','CX','CXO','CXP','CXRX','CXW','CY','CYBR','CYCC','CYH','CYOU','CYRX','CYS','CYTK','CYTR','CYTX','CZR','CZZ','D','DAIO','DAKT','DAL','DAN','DAR','DARE','DATA','DB','DBA','DBB','DBC','DBD','DBE','DBEF','DBEU','DBJP','DBO','DBVT','DBX','DCAR','DCI','DCIX','DCOM','DCP','DCPH','DCT','DDD','DDM','DDR','DDS','DE','DEA','DECK','DEI','DELT','DEM','DENN','DEO','DEPO','DERM','DES','DESP','DF','DFEN','DFFN','DFIN','DFJ','DFRG','DFS','DG','DGAZ','DGII','DGLD','DGRO','DGRW','DGS','DGX','DHF','DHI','DHR','DHT','DHX','DHY','DIA','DIAX','DIG','DIN','DIOD','DIS','DISCA','DISCK','DISH','DJP','DK','DKS','DLB','DLNG','DLPH','DLPN','DLR','DLTH','DLTR','DLX','DM','DMPI','DNB','DNKN','DNLI','DNN','DNOW','DNP','DNR','DO','DOC','DOG','DON','DOOR','DORM','DOV','DOVA','DOX','DPG','DPLO','DPS','DPW','DPZ','DQ','DRE','DRH','DRI','DRIO','DRIP','DRN','DRNA','DRQ','DRRX','DRYS','DS','DSKE','DSL','DSLV','DSM','DSS','DST','DSU','DSW','DSX','DTE','DUK','DUST','DVA','DVAX','DVMT','DVN','DVY','DWDP','DWT','DX','DXC','DXCM','DXD','DXJ','DXLG','DXPE','DXR','DXTR','DY','E','EA','EAD','EARN','EARS','EAT','EBAY','EBIO','EBIX','EBND','EBR','EBS','EBSB','EC','ECA','ECH','ECHO','ECL','ECON','ECPG','ECR','ECYT','ED','EDC','EDD','EDGE','EDIT','EDR','EDU','EDZ','EE','EEFT','EELV','EEM','EEMO','EEMV','EEP','EEQ','EEV','EEX','EFA','EFAV','EFG','EFII','EFR','EFSC','EFT','EFV','EFX','EGAN','EGBN','EGC','EGHT','EGL','EGLE','EGLT','EGN','EGO','EGOV','EGP','EGRX','EGY','EHC','EHI','EHIC','EHTH','EIDO','EIG','EIGI','EIM','EIX','EKSO','EL','ELF','ELGX','ELLI','ELP','ELS','ELVT','ELY','EMAN','EMB','EMD','EME','EMES','EMKR','EMLC','EMLP','EMN','EMO','EMQQ','EMR','ENB','ENBL','ENDP','ENIA','ENIC','ENLC','ENLK','ENPH','ENR','ENS','ENSG','ENSV','ENT','ENTA','ENTG','ENV','ENVA','ENZ','EOCC','EOD','EOG','EOI','EOLS','EOS','EPAM','EPAY','EPC','EPD','EPE','EPHE','EPI','EPOL','EPP','EPR','EPZM','EQC','EQGP','EQIX','EQM','EQR','EQT','ERC','ERF','ERI','ERIC','ERII','ERJ','EROS','ERUS','ERX','ERY','ES','ESES','ESIO','ESL','ESNC','ESND','ESNT','ESPR','ESRT','ESRX','ESS','ESTE','ESV','ETE','ETFC','ETG','ETH','ETJ','ETM','ETN','ETP','ETR','ETSY','ETV','ETW','ETY','EUFN','EUM','EUO','EURN','EV','EVBG','EVC','EVEP','EVF','EVH','EVHC','EVLV','EVR','EVRI','EVT','EVTC','EVV','EW','EWA','EWBC','EWC','EWD','EWG','EWH','EWI','EWJ','EWL','EWM','EWN','EWO','EWP','EWQ','EWS','EWT','EWU','EWW','EWY','EWZ','EXAS','EXC','EXEL','EXG','EXK','EXLS','EXP','EXPD','EXPE','EXPR','EXR','EXTN','EXTR','EYE','EYEG','EYES','EYPT','EZA','EZPW','EZU','F','FAF','FAMI','FANG','FANH','FARO','FAS','FAST','FATE','FAX','FAZ','FB','FBC','FBHS','FBIO','FBM','FBP','FBR','FCAU','FCB','FCE-A','FCEL','FCF','FCFS','FCG','FCN','FCPT','FCSC','FCX','FDC','FDD','FDIS','FDL','FDN','FDP','FDS','FDT','FDUS','FDX','FE','FEI','FELE','FEM','FENG','FENX','FENY','FEP','FET','FEX','FEYE','FEZ','FFBC','FFC','FFIN','FFIV','FFTY','FFWM','FG','FGEN','FGP','FHB','FHLC','FHN','FI','FIBK','FICO','FIDU','FII','FINL','FIS','FISV','FIT','FITB','FIVE','FIVN','FIX','FIXX','FIZZ','FL','FLDM','FLEX','FLIR','FLO','FLOT','FLOW','FLR','FLRN','FLS','FLT','FLTR','FLWS','FLXN','FLY','FM','FMAT','FMBI','FMC','FMI','FMO','FMS','FMSA','FMX','FN','FNB','FNCL','FNCX','FND','FNDA','FNDC','FNDE','FNDF','FNDX','FNF','FNGN','FNGU','FNJN','FNKO','FNSR','FNV','FOE','FOLD','FOMX','FOR','FORD','FORK','FORM','FOSL','FOX','FOXA','FOXF','FPE','FPF','FPH','FPI','FPRX','FR','FRA','FRAC','FRAN','FRBK','FRC','FRED','FREL','FRGI','FRME','FRO','FRPT','FRT','FRTA','FSCT','FSD','FSIC','FSLR','FSM','FSNN','FSP','FSS','FTAI','FTCS','FTD','FTEC','FTFT','FTGC','FTI','FTK','FTNT','FTR','FTRPR','FTS','FTSI','FTSL','FTSM','FTV','FTXO','FUL','FULT','FUN','FV','FVD','FWONA','FWONK','FWRD','FXD','FXE','FXI','FXL','FXN','FXO','FXR','FXU','FXY','FXZ','G','GAB','GAIA','GAIN','GALT','GASL','GATX','GBCI','GBDC','GBT','GBX','GCAP','GCI','GCO','GCP','GD','GDDY','GDEN','GDI','GDOT','GDS','GDV','GDX','GDXJ','GE','GEF','GEL','GEM','GEMP','GEN','GENE','GEO','GER','GERN','GES','GEVO','GFF','GFI','GG','GGAL','GGB','GGG','GGN','GGP','GHDX','GHG','GHL','GHY','GIB','GIII','GIL','GILD','GIM','GIS','GKOS','GLAD','GLBS','GLD','GLDD','GLNG','GLO','GLOB','GLOG','GLOP','GLOW','GLPG','GLPI','GLRE','GLT','GLUU','GLW','GLYC','GM','GME','GMED','GMLP','GMO','GMRE','GMS','GMZ','GNBC','GNC','GNCA','GNK','GNL','GNMK','GNMX','GNPX','GNR','GNRC','GNRT','GNTX','GNW','GOF','GOGL','GOGO','GOL','GOLD','GOLF','GOOD','GOOG','GOOGL','GOOS','GORO','GOV','GOVT','GPAQ','GPAQU','GPC','GPI','GPK','GPL','GPM','GPMT','GPN','GPOR','GPRE','GPRK','GPRO','GPS','GPT','GRA','GRAM','GREK','GRFS','GRMN','GROW','GRPN','GRUB','GS','GSAT','GSBD','GSG','GSIE','GSK','GSLC','GSM','GSS','GST','GSUM','GSV','GSVC','GSY','GT','GTE','GTES','GTHX','GTLS','GTN','GTS','GTT','GTXI','GTY','GUNR','GUSH','GUT','GV','GVA','GVI','GWB','GWPH','GWR','GWRE','GWW','GWX','GXG','GXP','H','HA','HABT','HACK','HAE','HAFC','HAIN','HAIR','HAL','HALO','HAS','HASI','HAWK','HAYN','HBAN','HBHC','HBI','HBIO','HBM','HCA','HCC','HCHC','HCI','HCKT','HCLP','HCP','HCSG','HD','HDB','HDGE','HDNG','HDP','HDS','HDSN','HDV','HE','HEAR','HEB','HEDJ','HEES','HEFA','HEI','HEI-A','HELE','HEP','HES','HESM','HEWG','HEWJ','HEZU','HF','HFC','HFWA','HFXI','HGT','HGV','HHC','HI','HIBB','HIFR','HIG','HII','HIIQ','HIL','HIMX','HIO','HIVE','HIW','HIX','HK','HL','HLF','HLG','HLI','HLIT','HLNE','HLT','HLTH','HLX','HMC','HMHC','HMI','HMLP','HMN','HMNY','HMST','HMSY','HMY','HNI','HOG','HOLI','HOLX','HOMB','HOME','HON','HOPE','HOS','HOV','HP','HPE','HPP','HPQ','HPR','HPT','HQH','HQY','HR','HRB','HRC','HRG','HRI','HRL','HRS','HRTG','HRTX','HSBC','HSC','HSIC','HSII','HSKA','HST','HSTM','HSY','HT','HTA','HTBK','HTBX','HTD','HTGC','HTGM','HTH','HTHT','HTLD','HTLF','HTM','HTZ','HUBB','HUBG','HUBS','HUD','HUM','HUN','HURN','HUSA','HVT','HXL','HYD','HYEM','HYG','HYH','HYLB','HYLS','HYS','HYT','HYZD','HZN','HZNP','HZO','I','IAC','IAG','IAI','IART','IAT','IAU','IBB','IBDK','IBDL','IBDM','IBDN','IBIO','IBKC','IBKR','IBM','IBN','IBND','IBOC','IBP','IBTX','ICD','ICE','ICF','ICFI','ICHR','ICL','ICLK','ICLN','ICLR','ICON','ICPT','ICUI','IDA','IDCC','IDRA','IDT','IDTI','IDV','IDXG','IDXX','IEA','IEF','IEFA','IEI','IEMG','IEP','IEUR','IEV','IEX','IFF','IFGL','IFN','IFV','IGC','IGD','IGF','IGOV','IGR','IGT','IGV','IHG','IIIN','IIM','IIPR','IIVI','IJH','IJK','IJR','IJS','IJT','ILF','ILG','ILMN','IMAX','IMDZ','IMGN','IMKTA','IMMR','IMMU','IMMY','IMNP','IMO','IMPV','IMUC','INAP','INCY','INDA','INDY','INFI','INFN','INFO','INFY','ING','INGN','INGR','INN','INNT','INO','INOV','INPX','INSG','INSM','INST','INSW','INSY','INT','INTC','INTF','INTL','INTU','INVA','INVH','INWK','INXN','IO','IONS','IOSP','IOTS','IOVA','IP','IPAR','IPAS','IPCC','IPCI','IPG','IPGP','IPHI','IPHS','IPI','IPOA','IPWR','IPXL','IQ','IQDF','IQI','IQV','IR','IRBT','IRDM','IRET','IRM','IRT','IRTC','IRWD','ISBC','ISCA','ISD','ISR','ISRG','ISTB','IT','ITA','ITB','ITCI','ITG','ITGR','ITI','ITM','ITOT','ITRI','ITT','ITUB','ITUS','ITW','IUSB','IUSG','IUSV','IVAC','IVC','IVE','IVR','IVTY','IVV','IVW','IVZ','IWB','IWD','IWF','IWM','IWN','IWO','IWP','IWR','IWS','IWV','IXC','IXUS','IYE','IYF','IYG','IYH','IYM','IYR','IYT','IYW','IYZ','IZEA','JACK','JAG','JAGX','JAKK','JASO','JAZZ','JBGS','JBHT','JBL','JBLU','JBT','JCAP','JCI','JCOM','JCP','JD','JDST','JE','JEC','JELD','JFR','JHG','JILL','JKHY','JKS','JLL','JMEI','JNCE','JNJ','JNK','JNP','JNPR','JNUG','JOBS','JOE','JONE','JP','JPC','JPIN','JPM','JPS','JPST','JQC','JRJR','JRO','JRS','JRVR','JT','JW-A','JWN','K','KAAC','KALA','KALU','KAMN','KANG','KAR','KB','KBA','KBAL','KBE','KBH','KBR','KBSF','KBWB','KDMN','KEG','KELYA','KEM','KEP','KERX','KEX','KEY','KEYS','KEYW','KFRC','KFY','KGC','KHC','KIE','KIM','KIRK','KKR','KL','KLAC','KLDX','KLIC','KLXI','KMB','KMG','KMI','KMPH','KMPR','KMT','KMX','KN','KND','KNDI','KNL','KNOP','KNX','KO','KODK','KONE','KOP','KOPN','KORS','KOS','KPTI','KR','KRA','KRC','KRE','KRG','KRNT','KRNY','KRO','KS','KSA','KSS','KSU','KT','KTF','KTOS','KTOV','KTWO','KURA','KW','KWEB','KYE','KYN','L','LABD','LABL','LABU','LAC','LACQ','LAD','LADR','LAMR','LANC','LAUR','LAYN','LAZ','LB','LBAI','LBCC','LBRDA','LBRDK','LBRT','LBTYA','LBTYK','LBY','LC','LCI','LCII','LDOS','LE','LEA','LECO','LEDS','LEE','LEG','LEJU','LEMB','LEN','LEN-B','LEO','LEXEA','LFC','LFUS','LGC','LGCY','LGF-A','LGF-B','LGIH','LGND','LH','LHCG','LHO','LII','LILA','LILAK','LIND','LINU','LION','LIQT','LIT','LITE','LIVN','LJPC','LKM','LKQ','LKSD','LL','LLEX','LLL','LLNW','LLY','LM','LMAT','LMBS','LMFA','LMNX','LMT','LN','LNC','LNG','LNT','LNTH','LOB','LOCO','LODE','LOGI','LOGM','LOMA','LOPE','LOW','LOXO','LPCN','LPG','LPI','LPL','LPLA','LPNT','LPSN','LPT','LPTH','LPTX','LPX','LQ','LQD','LQDT','LRCX','LRGF','LRN','LSCC','LSI','LSTR','LSXMA','LSXMK','LTBR','LTC','LTM','LTN','LTRPA','LTS','LTXB','LUK','LULU','LUNA','LUV','LVHD','LVS','LW','LX','LXFT','LXP','LXRX','LXU','LYB','LYG','LYTS','LYV','LZB','M','MA','MAA','MAC','MACK','MAG','MAIN','MAN','MANH','MANT','MAR','MARA','MARK','MAS','MASI','MAT','MATR','MATW','MATX','MAXR','MB','MBB','MBFI','MBI','MBII','MBOT','MBRX','MBT','MBUU','MBVX','MC','MCA','MCC','MCD','MCF','MCFT','MCHI','MCHP','MCHX','MCK','MCO','MCR','MCRB','MCRN','MCY','MD','MDB','MDC','MDCA','MDCO','MDGL','MDIV','MDLZ','MDP','MDR','MDRX','MDSO','MDT','MDU','MDXG','MDY','MED','MEDP','MEET','MEI','MELI','MEOH','MERC','MET','MFA','MFC','MFG','MFGP','MFL','MGA','MGEN','MGI','MGK','MGLN','MGM','MGNX','MGP','MGPI','MGRC','MHK','MHLD','MHO','MIC','MICT','MIDD','MIE','MIK','MIME','MIN','MINI','MINT','MITK','MITL','MITT','MIXT','MJ','MKC','MKSI','MKTX','MLCO','MLHR','MLI','MLM','MLNT','MLNX','MLPA','MLPI','MLPX','MMC','MMDM','MMI','MMLP','MMM','MMP','MMS','MMSI','MMT','MMYT','MNA','MNGA','MNK','MNKD','MNLO','MNOV','MNR','MNRO','MNST','MNTA','MO','MOAT','MOBL','MOD','MODN','MOG-A','MOH','MOMO','MON','MOR','MORL','MOS','MOSY','MOV','MPAA','MPC','MPLX','MPO','MPW','MPWR','MRAM','MRC','MRCC','MRCY','MRDN','MRK','MRNS','MRO','MRSN','MRT','MRTN','MRTX','MRVL','MS','MSA','MSB','MSCC','MSCI','MSFT','MSG','MSGN','MSI','MSM','MT','MTB','MTBC','MTCH','MTD','MTDR','MTG','MTGE','MTH','MTL','MTN','MTNB','MTOR','MTRN','MTRX','MTSI','MTUM','MTW','MTX','MTZ','MU','MUB','MUC','MUDS','MUDSU','MUI','MULE','MUR','MUSA','MUX','MVF','MVIS','MWA','MX','MXIM','MXL','MXWL','MYD','MYGN','MYI','MYL','MYND','MYO','MYOK','MYSZ','MZOR','NAC','NAD','NAK','NANO','NANR','NAO','NAP','NAT','NATI','NAV','NAVB','NAVI','NBEV','NBHC','NBIX','NBL','NBLX','NBR','NBRV','NBTB','NCI','NCLH','NCMI','NCNA','NCR','NCS','NCSM','NCTY','NCV','NCZ','NDAQ','NDLS','NDSN','NE','NEA','NEAR','NEE','NEM','NEO','NEOG','NEON','NEOS','NEP','NEPT','NERV','NESR','NETE','NEWA','NEWM','NEWR','NEWT','NEXA','NFBK','NFEC','NFG','NFJ','NFLX','NFX','NG','NGD','NGG','NGHC','NGL','NGVC','NGVT','NHF','NHI','NI','NICE','NIHD','NINE','NJR','NK','NKE','NKTR','NKX','NLNK','NLS','NLSN','NLST','NLY','NM','NMFC','NMIH','NMM','NMR','NMRK','NMZ','NNA','NNBR','NNN','NNVC','NOAH','NOBL','NOC','NOG','NOK','NOMD','NOV','NOVT','NOW','NPO','NPTN','NR','NRE','NRG','NRK','NRO','NRZ','NS','NSA','NSC','NSH','NSIT','NSM','NSP','NSPR','NSTG','NSU','NTAP','NTB','NTCT','NTEC','NTES','NTG','NTGR','NTLA','NTNX','NTR','NTRA','NTRI','NTRS','NUAN','NUE','NUGT','NURO','NUS','NUV','NUVA','NVAX','NVCN','NVCR','NVDA','NVFY','NVG','NVGS','NVMI','NVO','NVRO','NVS','NVTA','NVTR','NWBI','NWBO','NWE','NWL','NWN','NWS','NWSA','NWY','NX','NXE','NXEO','NXPI','NXST','NXTD','NXTM','NYCB','NYLD','NYLD-A','NYMT','NYMX','NYRT','NYT','NZF','O','OA','OAK','OAKS','OAS','OBE','OC','OCFC','OCLR','OCN','OCSL','OCUL','ODFL','ODP','OEC','OEF','OFC','OFG','OFIX','OGE','OGEN','OGS','OHGI','OHI','OHRP','OI','OIBR-C','OIH','OII','OILD','OILU','OIS','OKE','OKTA','OLED','OLLI','OLN','OMC','OMCL','OMED','OMER','OMEX','OMF','OMI','OMN','ON','ONB','ONCE','ONCS','ONDK','ONE','ONTX','ONVO','OPB','OPESU','OPGN','OPHT','OPK','OPTT','OR','ORA','ORAN','ORBC','ORBK','ORC','ORCL','ORI','ORIG','ORIT','ORLY','OSB','OSG','OSIS','OSK','OSN','OSPR','OSTK','OSUR','OTEX','OTIC','OTIV','OUT','OVAS','OVID','OXFD','OXLC','OXM','OXSQ','OXY','OZM','OZRK','P','PAA','PAAS','PACB','PACQU','PACW','PAG','PAGP','PAGS','PAH','PAHC','PAM','PANW','PARR','PATK','PAY','PAYC','PAYX','PB','PBA','PBCT','PBF','PBH','PBI','PBP','PBPB','PBR','PBR-A','PBYI','PCAR','PCEF','PCG','PCH','PCI','PCMI','PCRX','PCTY','PCY','PDBC','PDCE','PDCO','PDFS','PDI','PDLI','PDM','PDP','PDS','PDT','PE','PEB','PED','PEG','PEGA','PEGI','PEI','PEIX','PEN','PENN','PEO','PEP','PER','PERI','PES','PETQ','PETS','PETX','PEY','PF','PFE','PFF','PFG','PFGC','PFIE','PFLT','PFN','PFNX','PFPT','PFS','PFSI','PFXF','PG','PGF','PGH','PGHY','PGNX','PGR','PGRE','PGTI','PGX','PH','PHB','PHG','PHH','PHK','PHM','PHT','PHYS','PI','PICK','PICO','PID','PII','PINC','PIR','PIRS','PIXY','PJC','PJT','PK','PKD','PKE','PKG','PKI','PKX','PLAB','PLAY','PLCE','PLD','PLG','PLM','PLNT','PLSE','PLT','PLUG','PLX','PLXS','PLYA','PM','PML','PMM','PMT','PNC','PNFP','PNK','PNM','PNNT','PNR','PNW','PODD','POL','POOL','POR','POST','POWI','PPA','PPBI','PPC','PPDF','PPG','PPH','PPL','PPR','PPT','PQ','PQG','PRA','PRAA','PRAH','PRF','PRFT','PRGO','PRGS','PRI','PRIM','PRKR','PRLB','PRMW','PRO','PRPO','PRTA','PRTK','PRTS','PRTY','PRU','PSA','PSDO','PSEC','PSLV','PSMT','PSO','PSP','PSQ','PSTG','PSTI','PSX','PSXP','PTC','PTCT','PTEN','PTGX','PTI','PTLA','PTLC','PTN','PTR','PTX','PTY','PUK','PULM','PUMP','PUTW','PVAC','PVG','PVH','PVTL','PWR','PWV','PX','PXD','PXF','PXH','PXLW','PXS','PYDS','PYPL','PZA','PZZA','QAI','QARP','QCOM','QCP','QD','QDEL','QEP','QES','QGEN','QHC','QID','QIWI','QLD','QLYS','QNST','QQQ','QQQX','QRTEA','QRVO','QSII','QSR','QTEC','QTM','QTNA','QTNT','QTRH','QTRX','QTS','QTWO','QUAD','QUAL','QUIK','QUOT','QURE','R','RA','RACE','RAD','RADA','RARE','RARX','RAS','RAVN','RBA','RBBN','RBC','RBS','RCI','RCII','RCKT','RCL','RCM','RCON','RCS','RCUS','RDC','RDFN','RDN','RDNT','RDS-A','RDS-B','RDUS','RDVY','RDWR','RDY','RE','RECN','REDU','REET','REG','REGI','REGN','REI','RELX','REM','REMX','REN','RENN','REPH','RES','RESI','RESN','RETA','RETO','REVG','REXR','REXX','RF','RFIL','RFP','RGA','RGEN','RGLD','RGLS','RGNX','RGR','RGS','RGSE','RH','RHE','RHI','RHP','RHT','RIG','RIGL','RIGS','RING','RIO','RIOT','RJF','RJI','RKDA','RL','RLGT','RLGY','RLI','RLJ','RMAX','RMBS','RMD','RMGN','RMP','RMT','RMTI','RNG','RNN','RNP','RNR','RNST','RNVA','RNWK','ROBO','ROCK','RODM','ROG','ROIC','ROK','ROKU','ROL','ROP','ROSG','ROST','ROX','ROYT','RP','RPAI','RPD','RPG','RPM','RPT','RPV','RPXC','RQI','RRC','RRD','RRGB','RRR','RRTS','RS','RSG','RSLS','RSO','RSP','RSPP','RST','RSX','RSYS','RTEC','RTIX','RTN','RTRX','RTTR','RUBI','RUN','RUSHA','RUSL','RUSS','RUTH','RVLT','RVNC','RVP','RVT','RWGE','RWLK','RWM','RWO','RWR','RWT','RWX','RXII','RXN','RY','RYAAY','RYAM','RYB','RYI','RYN','S','SA','SABR','SAFM','SAGE','SAH','SAIA','SAIC','SAIL','SALT','SAM','SAN','SAND','SANM','SAP','SASR','SATS','SAVE','SB','SBAC','SBBP','SBCF','SBGI','SBGL','SBH','SBLK','SBNY','SBRA','SBS','SBSI','SBUX','SC','SCCO','SCG','SCHA','SCHB','SCHC','SCHD','SCHE','SCHF','SCHG','SCHH','SCHK','SCHL','SCHM','SCHN','SCHO','SCHP','SCHR','SCHV','SCHW','SCHX','SCHZ','SCI','SCJ','SCO','SCON','SCS','SCSC','SCVL','SCWX','SCYX','SCZ','SD','SDIV','SDLP','SDOG','SDOW','SDR','SDRL','SDS','SDT','SDY','SE','SEA','SEAC','SEAS','SECO','SEDG','SEE','SEED','SEIC','SELB','SEM','SEMG','SEND','SENS','SEP','SERV','SF','SFBS','SFE','SFIX','SFL','SFLY','SFM','SFNC','SFS','SFUN','SGEN','SGH','SGMO','SGMS','SGRY','SGU','SGY','SGYP','SH','SHAK','SHEN','SHIP','SHLD','SHLM','SHLO','SHLX','SHM','SHO','SHOO','SHOP','SHOS','SHPG','SHV','SHW','SHY','SHYG','SID','SIEN','SIFY','SIG','SIGI','SIGM','SIL','SILC','SIMO','SINA','SINO','SIR','SIRI','SITE','SITO','SIVB','SIVR','SIX','SJB','SJI','SJM','SJNK','SJR','SJT','SJW','SKM','SKT','SKX','SKYW','SKYY','SLAB','SLB','SLCA','SLDB','SLF','SLG','SLGN','SLM','SLQD','SLRC','SLS','SLV','SM','SMCI','SMFG','SMG','SMH','SMI','SMLP','SMP','SMPL','SMRT','SMSI','SMTC','SN','SNA','SNAP','SNBR','SNCR','SND','SNDR','SNDX','SNE','SNGX','SNH','SNHY','SNLN','SNMX','SNN','SNNA','SNOA','SNP','SNPS','SNR','SNSS','SNV','SNX','SNY','SO','SOCL','SODA','SOGO','SOHU','SOI','SON','SONC','SORL','SOXL','SOXS','SOXX','SPA','SPAB','SPAR','SPB','SPDW','SPEM','SPEX','SPG','SPGI','SPH','SPHB','SPHD','SPHQ','SPHS','SPI','SPIB','SPKE','SPLB','SPLG','SPLK','SPLV','SPMD','SPN','SPOK','SPOT','SPPI','SPR','SPSB','SPSC','SPSM','SPTL','SPTM','SPTN','SPTS','SPWH','SPWR','SPXC','SPXL','SPXS','SPXU','SPY','SPYD','SPYG','SPYV','SQ','SQBG','SQM','SQNS','SQQQ','SR','SRAX','SRC','SRCI','SRCL','SRE','SREV','SRG','SRI','SRLN','SRNE','SRPT','SRRA','SRT','SRTY','SSB','SSC','SSD','SSI','SSL','SSNC','SSO','SSP','SSRM','SSTI','SSTK','SSW','SSYS','ST','STAA','STAG','STAR','STAY','STB','STBA','STBZ','STC','STE','STG','STI','STIP','STKL','STL','STLD','STM','STML','STMP','STNG','STNLU','STO','STON','STOR','STPZ','STRL','STT','STWD','STX','STZ','SU','SUI','SUM','SUN','SUP','SUPN','SUPV','SURF','SVM','SVRA','SVU','SVXY','SWCH','SWIR','SWK','SWKS','SWM','SWN','SWX','SXC','SXCP','SXE','SXT','SYBX','SYF','SYK','SYKE','SYMC','SYN','SYNA','SYNC','SYNH','SYNT','SYRS','SYY','T','TA','TACO','TAHO','TAL','TAN','TANH','TAP','TAST','TAT','TBBK','TBF','TBI','TBK','TBPH','TBT','TCAP','TCBI','TCF','TCMD','TCO','TCON','TCP','TCPC','TCRD','TCS','TD','TDC','TDG','TDOC','TDS','TDTT','TDW','TDY','TEAM','TEAR','TECD','TECH','TECK','TECL','TECS','TEDU','TEF','TEGP','TEI','TEL','TELL','TEN','TENX','TEO','TEP','TER','TERP','TEUM','TEVA','TEX','TFI','TFSL','TFX','TGB','TGH','TGI','TGNA','TGP','TGS','TGT','TGTX','THC','THD','THG','THM','THO','THQ','THR','THRM','THS','THW','TI','TIBRU','TIER','TIF','TILE','TIP','TISI','TITN','TIVO','TJX','TK','TKC','TKR','TLGT','TLK','TLND','TLRA','TLRD','TLT','TLYS','TM','TMF','TMFC','TMHC','TMK','TMO','TMQ','TMST','TMUS','TMV','TNA','TNC','TNDM','TNET','TNK','TNP','TNTR','TOCA','TOL','TOO','TOPS','TORC','TOT','TOTL','TOUR','TOWN','TOWR','TPC','TPGE','TPH','TPIC','TPLM','TPR','TPRE','TPX','TQQQ','TR','TRCH','TRCO','TREE','TREX','TRGP','TRHC','TRI','TRIP','TRMB','TRMK','TRN','TRNC','TRNO','TROV','TROW','TROX','TRP','TRPX','TRQ','TRS','TRST','TRTN','TRTX','TRU','TRUE','TRUP','TRV','TRVG','TRVN','TRX','TRXC','TS','TSC','TSCO','TSE','TSEM','TSG','TSLA','TSLX','TSM','TSN','TSRO','TSS','TST','TSU','TTC','TTD','TTEK','TTGT','TTI','TTM','TTMI','TTNP','TTOO','TTPH','TTS','TTT','TTWO','TU','TUES','TUP','TUR','TUSK','TV','TVIX','TVPT','TVTY','TWI','TWLO','TWM','TWNK','TWO','TWOU','TWTR','TWX','TX','TXMD','TXN','TXRH','TXT','TYG','TYL','TYME','TYPE','TZA','UA','UAA','UAL','UAN','UAVS','UBIO','UBNK','UBNT','UBS','UBSH','UBSI','UCBI','UCO','UCTT','UDOW','UDR','UE','UEC','UEPS','UFCS','UFPI','UFS','UGAZ','UGI','UGLD','UGP','UHS','UIHC','UIS','UL','ULTA','ULTI','UMBF','UMC','UMH','UMPQ','UMRX','UN','UNFI','UNG','UNH','UNIT','UNM','UNP','UNT','UNVR','UPL','UPLD','UPRO','UPS','UQM','URA','URBN','URG','URGN','URI','URTY','USA','USAC','USAK','USAT','USAU','USB','USCR','USFD','USG','USLV','USM','USMC','USMV','USNA','USO','USRT','UTF','UTG','UTHR','UTX','UUP','UUUU','UVE','UVSP','UVV','UVXY','UWM','UWT','V','VAC','VALE','VAR','VAW','VB','VBIV','VBK','VBLT','VBR','VBTX','VC','VCEL','VCIT','VCLT','VCR','VCRA','VCSH','VCTR','VCV','VCYT','VDC','VDE','VDSI','VEA','VEC','VECO','VEDL','VEEV','VEON','VER','VERI','VERU','VET','VEU','VFC','VFH','VG','VGI','VGIT','VGK','VGLT','VGM','VGR','VGSH','VGT','VGZ','VHC','VHI','VHT','VIAB','VIAV','VICL','VICR','VIG','VII','VIIX','VIPS','VIRT','VIS','VIV','VIVE','VIVO','VIXY','VKQ','VKTX','VLO','VLP','VLRS','VLUE','VLY','VMBS','VMC','VMI','VMIN','VMO','VMW','VNDA','VNET','VNM','VNO','VNOM','VNQ','VNQI','VNRX','VNTR','VO','VOD','VOE','VOO','VOT','VOX','VOYA','VPL','VPU','VR','VRA','VRAY','VREX','VRNS','VRNT','VRP','VRS','VRSK','VRSN','VRTU','VRTV','VRTX','VRX','VSAR','VSAT','VSH','VSI','VSLR','VSM','VSS','VST','VSTM','VSTO','VT','VTA','VTEB','VTGN','VTI','VTIP','VTL','VTR','VTV','VTVT','VUG','VUZI','VV','VVC','VVI','VVR','VVUS','VVV','VWO','VXF','VXUS','VXX','VXZ','VYGR','VYM','VYMI','VZ','W','WAAS','WAB','WABC','WAFD','WAGE','WAIR','WAL','WAT','WATT','WB','WBA','WBAI','WBC','WBK','WBS','WBT','WCC','WCG','WCN','WD','WDAY','WDC','WDR','WEAT','WEB','WEC','WELL','WEN','WERN','WES','WETF','WEX','WFC','WFT','WGL','WGO','WGP','WHD','WHLR','WHR','WIFI','WIN','WING','WIP','WIT','WIX','WK','WKHS','WLB','WLH','WLK','WLL','WLTW','WM','WMB','WMC','WMGI','WMIH','WMS','WMT','WNC','WNS','WOR','WOW','WP','WPC','WPG','WPM','WPP','WPRT','WPS','WPX','WPZ','WR','WRB','WRD','WRE','WRI','WRK','WSBC','WSC','WSM','WSO','WSR','WST','WTFC','WTI','WTR','WTS','WTTR','WTW','WU','WUBA','WVE','WWD','WWE','WWR','WWW','WY','WYN','WYNN','WYY','X','XAR','XBI','XCRA','XEC','XEL','XENT','XES','XGTI','XHB','XHR','XIN','XL','XLB','XLE','XLF','XLI','XLK','XLNX','XLP','XLRE','XLRN','XLU','XLV','XLY','XME','XMLV','XMX','XNCR','XNET','XOG','XOM','XOMA','XON','XONE','XOP','XOXO','XPER','XPL','XPO','XRAY','XRF','XRT','XRX','XSD','XSLV','XSPA','XT','XXII','XYL','YANG','YELP','YEXT','YINN','YNDX','YPF','YRCW','YRD','YTEN','YTRA','YUM','YUMC','YY','Z','ZAGG','ZAYO','ZBH','ZBRA','ZEN','ZEUS','ZFGN','ZG','ZGNX','ZION','ZIOP','ZIV','ZIXI','ZN','ZNGA','ZOES','ZS','ZSAN','ZTO','ZTR','ZTS','ZUMZ','ZUO','ZYNE']

date_from = '2015-01-01'
date_to = '2016-01-01'

conn = sqlite3.connect('stocks.db')
c = conn.cursor()

processed_tickers = []
batched_data = stockslib.getQuandlBatchedData(symbols, date_from, date_to)
for batch in batched_data:
    for ticker in batch:
        data = batch[ticker]
        v_ticker = ticker

        length = len(data['date'])
        for i in range(length):
            v_date = data['date'][i].date()
            v_open = data['open'][i]
            v_high = data['high'][i]
            v_low = data['low'][i]
            v_close = data['close'][i]

            # if symbol-date exists, exception will be thrown
            try:
                c.execute("INSERT INTO stocks (symbol, date, open, high, low, close) VALUES (?, ?, ?, ?, ?, ?)", (v_ticker, v_date, v_open, v_high, v_low, v_close))
                conn.commit()
            except:
                pass

conn.close()
